<div class="bk-modal" id="bkDeleteEraModal" aria-hidden="true" hidden>
    <div class="bk-backdrop" data-bk-close></div>

    <div class="bk-dialog" role="dialog" aria-modal="true" aria-labelledby="bkDeleteTitle">
        <div class="bk-paper">
            <div class="bk-head">
                <div>
                    <div class="bk-kicker">Потвърждение</div>
                    <h3 class="bk-title" id="bkDeleteTitle">Изтриване на епоха</h3>
                </div>
                <button type="button" class="bk-x" aria-label="Close" data-bk-close>✕</button>
            </div>

            <div class="bk-body">
                <div class="bk-warning">
                    <div class="bk-warning-icon">⚠</div>
                    <div>
                        <div class="bk-warning-title">Това действие е необратимо.</div>
                        <div class="bk-warning-sub">Епохата ще бъде премахната от системата.</div>
                    </div>
                </div>

                <div class="bk-card">
                    <div class="bk-card-title" id="bkDeleteEraName">—</div>
                    <div class="bk-card-sub" id="bkDeleteEraPeriod">—</div>
                </div>
            </div>

            <div class="bk-foot">
                <button type="button" class="bk-btn bk-btn-ghost" data-bk-close>Отказ</button>

                <form asp-controller="Eras" asp-action="Delete" method="post" class="bk-inline">
                    @Html.AntiForgeryToken()
                    <input type="hidden" name="id" id="bkDeleteEraId" />
                    <button type="submit" class="bk-btn bk-btn-danger">Изтрий</button>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    (function () {
        const modal = document.getElementById('bkDeleteEraModal');
        if (!modal) return;

        const idInput = document.getElementById('bkDeleteEraId');
        const nameEl = document.getElementById('bkDeleteEraName');
        const periodEl = document.getElementById('bkDeleteEraPeriod');

        function openModal({ id, name, start, end }) {
            if (idInput) idInput.value = id || '';
            if (nameEl) nameEl.textContent = name || '—';

            const s = (start ?? '').toString().trim();
            const e = (end ?? '').toString().trim();
            if (periodEl) {
                periodEl.textContent = (s || e) ? `${s || '…'} – ${e || '…'}` : '—';
            }

            modal.hidden = false;
            modal.setAttribute('aria-hidden', 'false');
            modal.classList.add('is-open');
            document.body.classList.add('bk-modal-open');
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            modal.classList.remove('is-open');
            modal.setAttribute('aria-hidden', 'true');
            modal.hidden = true;
            document.body.classList.remove('bk-modal-open');
            document.body.style.overflow = '';
        }


        document.addEventListener('click', (e) => {
            const btn = e.target.closest('[data-bk-delete-era]');
            if (!btn) return;

            openModal({
                id: btn.getAttribute('data-id'),
                name: btn.getAttribute('data-name'),
                start: btn.getAttribute('data-start'),
                end: btn.getAttribute('data-end')
            });
        });

        modal.addEventListener('click', (e) => {
            if (e.target.closest('[data-bk-close]')) closeModal();
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && modal.hidden === false) closeModal();
        });

        closeModal();
    })();
</script>